<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>查看全部读者</title>
</head>
<body>
    <script src="../js/daoru1.js"></script>
    <link href="../css/ui.jqgrid-bootstrap.css" rel="stylesheet">
    <link href="../css/ui.jqgrid-bootstrap-ui.css" rel="stylesheet">
    <script src="../js/jquery.jqGrid.js"></script>
    <script src="../js/grid.locale-cn.js"></script>
    <br>
    <br>
    <br>
    <br>
    <div class="content">
    <div class="row">
        <div class="">
            <div class="grid-btn">
                &nbsp;&nbsp;&nbsp;
                &nbsp;&nbsp;&nbsp;
                &nbsp;&nbsp;&nbsp;
                <button class="btn btn-info" onclick="userAdd()">
                    <i class="fa fa-plus"></i>&nbsp;新增
                </button>
                <button class="btn btn-warning" onclick="userEdit()">
                    <i class="fa fa-edit"></i>&nbsp;编辑
                </button>
                <button class="btn btn-danger " onclick="userDelete()">
                    <i class="fa fa-edit"></i>&nbsp;删除
                </button>
            </div>
            <table id="jqGrid" class="table table-bordered" ></table>
            <div id="jqGridPager"></div>

            <!--<table class="table table-striped">-->
                <!--<thead>-->
                <!--<tr>-->
                    <!--<th>读者证号</th>-->
                    <!--<th>姓名</th>-->
                    <!--<th>性别</th>-->
                    <!--<th>生日</th>-->
                    <!--<th>地址</th>-->
                    <!--<th>电话</th>-->
                    <!--<th>-->
                        <!--<input type='checkbox' id="check11">-->
                        <!--全选-->
                        <!--<button class='btn btn-info btn-primary btn-sm' id="delete">批量删除</button>-->
                    <!--</th>-->

                <!--</tr>-->
                <!--</thead>-->
                <!--<tbody id="tbody">-->
                <!--<tr>-->
                    <!--<td>-->

                    <!--</td>-->
                <!--</tr>-->
                <!--</tbody>-->
            <!--</table>-->
        </div>
    </div>
    </div>
</div>
</div>
</body>
<script>

    $("#jqGrid").jqGrid({
        //请求后台 JSON 数据的 URL
        url: '/reader',
        // type:'get',
        //后台返回的数据格式
        datatype: "json",
        //列表信息，包括表头、宽度、是否显示、渲染参数等属性
        colModel: [
            {label: 'id', name: 'id', index: 'id', width: 50, hidden: true, key: true},
            {label: '读者证号', name: 'readerId', index: 'readerId', sortable: false, width: 80},
            {label: '姓名', name: 'name', index: 'name', sortable: false, width: 80},
            {label: '性别', name: 'sex', index: 'sex', sortable: false, width: 80},
            {label: '生日', name: 'birth', index: 'birth', sortable: false, width: 80},
            {label: '地址', name: 'address', index: 'address', sortable: false, width: 80},
            {label: '电话', name: 'telcode', index: 'telcode', sortable: false, width: 80}
        ],

        //表格高度，可自行调节
        height: 346,
        //默认一页显示多少条数据，可自行调节
        rowNum: 10,
        //翻页控制条中，每页显示记录数可选集合
        rowList: [10, 30, 50],
        //主题，这里选用的是 Bootstrap 主题
        styleUI: 'Bootstrap',
        //数据加载时显示的提示信息
        loadtext: '信息读取中...',
        //是否显示行号，默认值是 false，不显示
        rownumbers: true,
        //行号列的宽度
        rownumWidth: 35,
        //宽度是否自适应
        autowidth: true,
        //是否可以多选
        multiselect: true,
        //分页信息 DOM
        pager: "#jqGridPager",
        // 直接默认返回值是data
        jsonReader: {
            root: "list",           //数据列表模型
            page: "data.currPage",       //数据页码
            total: "totalPage",     //数据总页码
            records: "totalCount"   //数据总记录数
        },
        // 向后台请求的参数
        prmNames: {
            page: "page",
            rows: "limit"
            // order: "order"
        },

        // start和limit分别代表当前页数和10-20 20-30
        // 数据加载完成并且 DOM 创建完毕之后的回调函数
        gridComplete: function () {
            //隐藏 Grid 底部滚动条
            $("#jqGrid").closest(".ui-jqgrid-bdiv").css({"overflow-x": "hidden"});
        }
    });

    function userEdit() {
        var id = getSelectedRow();
        if (id == null) {
            return;
        }
        $('#userId').val(id);

        //点击编辑按钮后执行操作
        var modal = new Custombox.modal({
            content: {
                effect: 'fadein',
                target: '#modalEdit'
            }
        });
        modal.open();
    }


          function userAdd(){
               $(location).attr('href','/html/addReader.html');
          }

        //
        // $("#check11").click(function () {
        //     var hz = $("#check11").prop("checked");
        //     $(".qx").prop('checked',hz);
        // });

        //
        // $("#delete").click(function () {
        //     var zhi = $('input:checkbox:checked');
        //     var id = '';
        //     var str = '';
        //     $.each(zhi,function(){
        //       id = this.parentNode.parentNode.firstChild.innerHTML;
        //                     if(id!=null){
        //                         str += id+",";
        //                     }
        //         swal({
        //            title:"确定要删除这"+zhi.length+'个读者的数据吗',
        //             showCancelButton: true,
        //             confirmButtonColor: "#DD6B55",
        //             confirmButtonText: "确定！",
        //             cancelButtonText: "取消！",
        //             closeOnConfirm: false,
        //             closeOnCancel: false
        //         },function (isConfirm) {
        //              var s = JSON.stringify(str);
        //              console.log(s);
        //             if(isConfirm){
        //                 $.ajax({
        //                    url:"/reader1",
        //                     type:"post",
        //                     dataType: "json",
        //                     data:{"str":s},
        //                     success:function (result) {
        //                         if(result=="success"){
        //                             swal('删除成功','','success');
        //                             getAll();
        //                         }else {
        //                             swal('删除失败，因系统不可抗力导致','','error');
        //                         }
        //                     }
        //                 });
        //             }else {
        //                 swal("取消！", "停留在此页面", "info");
        //             }
        //         });
        //     });
        //          console.log(JSON.stringify(typeof str));
        // });


    $(function(){
        var name = Cookies.get('username');
        var name1 = Cookies.get('username2');
        if (name != null) {
            $('#loginUserName').text(name + ',欢迎您!');
        } else if (name1 !=null ) {
            $('#loginUserName').text(name1 + ',欢迎您!');
        } else {
            alert('未登录！非法访问!返回登陆页面');
            $(location).attr('href','/html/index.html');
        }
        $('#myCarousel').carousel({
            interval: 2000
        })
    });


        // function getAll() {
        //     $.ajax({
        //         url: "/reader",
        //         type: "get",
        //         dataType: "json",
        //         success:function (result) {
        //             var dataTR = "";
        //             $.each(result, function (index, value) {
        //                 dataTR +=
        //                     "<tr>" +
        //                     "<td>" + value.readerId + "</td>" +
        //                     "<td>" + value.name + "</td>" +
        //                     "<td>" + value.sex + "</td>" +
        //                     "<td>" + value.birth + "</td>" +
        //                     "<td>" + value.address + "</td>" +
        //                     "<td>" + value.telcode + "</td>" +
        //                     "<td>" +
        //                     "<input type='checkbox' class='qx'> " +
        //                     "</td>" +
        //                     "</tr>";
        //             });
        //             $("#tbody").html(dataTR);
        //         }
        //     });
        // }

</script>
</html>